<?php
$certificateData = "MIIE5zCCA8+gAwIBAgIQcU4aaTvnLkE8FjMzAtRKZTANBgkqhkiG9w0BAQsFADB/MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50ZWMgQ29ycG9yYXRpb24xHzAdBgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxMDAuBgNVBAMTJ1N5bWFudGVjIENsYXNzIDMgU0hBMjU2IENvZGUgU2lnbmluZyBDQTAeFw0xNTAyMjgwMDAwMDBaFw0xNzAyMjcyMzU5NTlaMG4xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTESMBAGA1UEBwwJQ3VwZXJ0aW5vMRMwEQYDVQQKDApBcHBsZSBJbmMuMRQwEgYDVQQLDAtJU08gUmFEIFNSRTETMBEGA1UEAwwKQXBwbGUgSW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALqr/uX/uo7PlTFdYNSWKa5lVM99fiUGeMPDV92osljJe8V/RDli1loSLKqNEkKUHX3ltRMFQPBLVie1jVoQ2NhC9FEY0UHJuhp9/LVPqYNptyS/ySqQaALVoXPUThOfd4jYxIA+OXlVSGrwJ8WHyLXOZWtfuFqgVfPPzBiu+G2TVk4D+IR5dM5Ni3sLfhTcbmU40frVYJV/KLN8AhLA7FRGrjYFQ19G6vUXvhEBQI/WS5P511oRn/w3bgpXYyV8LMeltvSC1x4LKwhhtUVXRRfr4vGHsGDleiqXszgJyZwbSvD0omhes4VNiq68sZUmbSLj5B2pakFLClaS1WWvlYkCAwEAAaOCAW4wggFqMAkGA1UdEwQCMAAwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMDMGYGA1UdIARfMF0wWwYLYIZIAYb4RQEHFwMwTDAjBggrBgEFBQcCARYXaHR0cHM6Ly9kLnN5bWNiLmNvbS9jcHMwJQYIKwYBBQUHAgIwGRoXaHR0cHM6Ly9kLnN5bWNiLmNvbS9ycGEwHwYDVR0jBBgwFoAUljtT8Hkzl699g+8uK8zKt4YecmYwKwYDVR0fBCQwIjAgoB6gHIYaaHR0cDovL3N2LnN5bWNiLmNvbS9zdi5jcmwwVwYIKwYBBQUHAQEESzBJMB8GCCsGAQUFBzABhhNodHRwOi8vc3Yuc3ltY2QuY29tMCYGCCsGAQUFBzAChhpodHRwOi8vc3Yuc3ltY2IuY29tL3N2LmNydDARBglghkgBhvhCAQEEBAMCBBAwFgYKKwYBBAGCNwIBGwQIMAYBAQABAf8wDQYJKoZIhvcNAQELBQADggEBAHkyo1PBnvH6yBI0htL2PZmhZVxgAXiiwXyOT4S5HjUzWnJni+GREZFuW/a07uCiz+2RfgjqArdddRpLHk6x/UphEbbYS0UjvLd1qEjCtiGj9hE0kmqoC6DA48LRYY+PJq89mkStI4uL7xYbo4UrTxQIaQ6IZvWhY8x6+7B+Y7407hxsJWWXWHHsRqMyHfgewM49k3LYqS4oEio8OQCJmTrlCPXsnWXbH88r4carKF6pPTI22wHKT/QPnp3ANoBLdXToVrs694kr9Q3IJFNdPcOj8DEApHtg97L2K0phzuXxTz/HgrwSTnpSxNpSJAjD+TgH3FRZYBqUz3xFYw/Ixqo=";
$beginpem = "-----BEGIN CERTIFICATE-----\n";
$endpem = "-----END CERTIFICATE-----";
$certificateData = $beginpem . chunk_split($certificateData, 64, "\n") . $endpem;
$public_key_handle = openssl_pkey_get_public($certificateData);
//$signature = "StdSn2v4gv68OdbHehLIG3hfdM3fdwdJ90FAkzaSEENfA1bQ81hlLcIG4Jk9oZ0Z+Bnvr1FlH6qKKle8qZ9AKAtvQ5nnZU/25+RgFlc/uu5xTV/kZS7jeLB5oZu1IMf2K3Wu/SF88U3wICiHbj6UEGiMAaHJFz6HuOKyx4V0BjvtYG1uvcFD+fXV3JAmA8p/PXqYFFBQUpeinFvs/o0CfPMHl9cGpdI7LpvGnfKyG0ga80bPTUvSsP2xYyXgpNueb5rgl5NPbNgtVxJOqGFT05581DcNBcgcPdp7D3dgYfzOoKFWRkwQEROTfHUXQgcVDQg3o/3uzqDrW2RNMOB/hw==";
$signature = "nElpw2VciExM5xhJA0P0H5RPQNst+es6F+Q4ORWyjzODXcp1xRMMgQjykA0P3MtkT0tWuLWEnzyiLqAPFwdfBUtOwCkB2NkoMN7WhqVxtilkTSwermpc6ss2mqKItfoEFUbeWaUUlSCiVelYzqtzAlc/m2qEV5y4EBcbWlpJ1t3W7QmV+09NGNn2Q/Cb5UQrSpEEDfdNP9Ik1+nR08S0QUhmIG3YcKo0uwazjS5IUuEaRGyvld+aHDtgmH/Ycx7tGsaxZ7elyxIIfuMWgoq0zKU3e7Mpvrlrv4H3j1lVTPpeVrdtZDLdmAyhgM0vDQ/vwnAGjtqiJSWN2jnFNnGFKA==";

//$signture_data = "RzoxMTY2ODk1OTY4Y29tLmluZmlwbGF5LnJ3AAABUaTZoh2o0R+L";
$signture_data = "Rzo4MzAxNTE0NzEyY29tLmluZmlwbGF5LnJ3AAABUxILYlH/xfaR";
$result = openssl_verify(base64_decode($signture_data), base64_decode($signature), $public_key_handle,OPENSSL_ALGO_SHA256);
if ($result == 1)
{
    var_dump("good");
}
elseif ($result == 0)
{
    var_dump('bad');
}
else
{
    echo "ugly, error checking signature";
}

?>

